# PyTorch ONNX Conversion Error Report

```
❌ Obtain model graph with `torch.export.export(..., strict=False)`
❌ Obtain model graph with `torch.export.export(..., strict=True)`
❌ Obtain model graph with `torch.jit.trace`
⚪ Decompose operators for ONNX compatibility
⚪ Translate the graph into ONNX
⚪ Run `onnx.checker` on the ONNX model
⚪ Execute the model with ONNX Runtime
⚪ Validate model output accuracy
```

Error message:

```pytb
# ⚠️ Errors from strategy 'TorchExportNonStrictStrategy': -----------------------

Traceback (most recent call last):

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 110, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 186, in _capture
    return torch.export.export(
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/__init__.py", line 368, in export
    return _export(
           ^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1035, in wrapper
    raise e

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1008, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/exported_program.py", line 128, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1970, in _export
    return _export_for_training(
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1035, in wrapper
    raise e

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1008, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/exported_program.py", line 128, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1834, in _export_for_training
    export_artifact = export_func(  # type: ignore[operator]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1772, in _non_strict_export
    aten_export_artifact = _to_aten_func(  # type: ignore[operator]
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1564, in _export_to_aten_ir_make_fx
    gm, graph_signature = transform(_make_fx_helper)(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1702, in _aot_export_non_strict
    gm, sig = aot_export(wrapped_mod, args, kwargs=kwargs, **flags)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1485, in _make_fx_helper
    gm = make_fx(
         ^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 2196, in wrapped
    return make_fx_tracer.trace(f, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 2134, in trace
    return self._trace_inner(f, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 2105, in _trace_inner
    t = dispatch_trace(
        ^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1138, in dispatch_trace
    graph = tracer.trace(root, concrete_args)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1694, in trace
    res = super().trace(root, concrete_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 843, in trace
    (self.create_arg(fn(*args)),),
                     ^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1193, in wrapped
    out = f(*tensors)  # type:ignore[call-arg]
          ^^^^^^^^^^^

  File "<string>", line 1, in <lambda>

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1469, in wrapped_fn
    return tuple(flat_fn(*args))
                 ^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/utils.py", line 184, in flat_fn
    tree_out = fn(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 879, in functional_call
    out = mod(*args[params_len:], **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 821, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1764, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 539, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 814, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1689, in forward
    tree_out = mod(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 821, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1764, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 539, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 814, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/kokoro/model.py", line 93, in forward
    d = self.predictor.text_encoder(d_en, s, input_lengths, text_mask)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 821, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1764, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 539, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 814, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/kokoro/modules.py", line 157, in forward
    input_lengths = text_lengths.cpu().numpy()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1241, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1288, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_export/non_strict_utils.py", line 557, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

RuntimeError: .numpy() is not supported for tensor subclasses.


# ⚠️ Errors from strategy 'TorchExportStrategy': -----------------------

Traceback (most recent call last):

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 110, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 145, in _capture
    return torch.export.export(
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/__init__.py", line 368, in export
    return _export(
           ^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1035, in wrapper
    raise e

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1008, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/exported_program.py", line 128, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1970, in _export
    return _export_for_training(
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1035, in wrapper
    raise e

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1008, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/exported_program.py", line 128, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1834, in _export_for_training
    export_artifact = export_func(  # type: ignore[operator]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1283, in _strict_export_lower_to_aten_ir
    gm_torch_level = _export_to_torch_ir(
                     ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 662, in _export_to_torch_ir
    gm_torch_level, _ = torch._dynamo.export(
                        ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1569, in inner
    result_traced = opt_f(*args, **kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 574, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 1380, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
    return _compile(
           ^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
    transformations(instructions, code_options)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
    super().run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py", line 443, in call_function
    return tx.inline_user_function_return(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 378, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2341, in CALL
    self._call(inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2335, in _call
    self.call_function(fn, args, kwargs)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py", line 443, in call_function
    return tx.inline_user_function_return(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 378, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2341, in CALL
    self._call(inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2335, in _call
    self.call_function(fn, args, kwargs)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 687, in call_function
    unimplemented(msg)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/exc.py", line 317, in unimplemented
    raise Unsupported(msg, case_name=case_name)

torch._dynamo.exc.Unsupported: 'skip function pack_padded_sequence in file /Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/utils/rnn.py'

from user code:
   File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/external_utils.py", line 45, in inner
    return fn(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/kokoro/model.py", line 93, in forward
    d = self.predictor.text_encoder(d_en, s, input_lengths, text_mask)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/kokoro/modules.py", line 166, in forward
    x = nn.utils.rnn.pack_padded_sequence(

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information



# ⚠️ Errors from strategy 'JitTraceConvertStrategy': -----------------------

Traceback (most recent call last):

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 110, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 294, in _capture
    ).convert()
      ^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_export/converter.py", line 1462, in convert
    ep = self.retrace_as_exported_program(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_export/converter.py", line 1514, in retrace_as_exported_program
    ep = torch.export._trace._export(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1035, in wrapper
    raise e

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1008, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/exported_program.py", line 128, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1970, in _export
    return _export_for_training(
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1035, in wrapper
    raise e

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1008, in wrapper
    ep = fn(*args, **kwargs)
         ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/exported_program.py", line 128, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1834, in _export_for_training
    export_artifact = export_func(  # type: ignore[operator]
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1772, in _non_strict_export
    aten_export_artifact = _to_aten_func(  # type: ignore[operator]
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1564, in _export_to_aten_ir_make_fx
    gm, graph_signature = transform(_make_fx_helper)(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1702, in _aot_export_non_strict
    gm, sig = aot_export(wrapped_mod, args, kwargs=kwargs, **flags)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1485, in _make_fx_helper
    gm = make_fx(
         ^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 2196, in wrapped
    return make_fx_tracer.trace(f, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 2134, in trace
    return self._trace_inner(f, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 2105, in _trace_inner
    t = dispatch_trace(
        ^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1138, in dispatch_trace
    graph = tracer.trace(root, concrete_args)  # type: ignore[arg-type]
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1694, in trace
    res = super().trace(root, concrete_args)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 745, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 843, in trace
    (self.create_arg(fn(*args)),),
                     ^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1193, in wrapped
    out = f(*tensors)  # type:ignore[call-arg]
          ^^^^^^^^^^^

  File "<string>", line 1, in <lambda>

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1469, in wrapped_fn
    return tuple(flat_fn(*args))
                 ^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/utils.py", line 184, in flat_fn
    tree_out = fn(*args, **kwargs)
               ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_functorch/_aot_autograd/traced_function_transforms.py", line 879, in functional_call
    out = mod(*args[params_len:], **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 821, in module_call_wrapper
    return self.call_module(mod, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1764, in call_module
    return Tracer.call_module(self, m, forward, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 539, in call_module
    ret_val = forward(*args, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/_symbolic_trace.py", line 814, in forward
    return _orig_module_call(mod, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/export/_trace.py", line 1687, in forward
    tree_out = torch.fx.Interpreter(mod).run(*args)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/interpreter.py", line 167, in run
    self.env[node] = self.run_node(node)
                     ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/interpreter.py", line 230, in run_node
    return getattr(self, n.op)(n.target, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/interpreter.py", line 310, in call_function
    return target(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_ops.py", line 723, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1241, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_ops.py", line 723, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1288, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_ops.py", line 723, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_export/non_strict_utils.py", line 557, in __torch_function__
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_ops.py", line 723, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_ops.py", line 840, in handler
    return torch._library.utils.handle_dispatch_mode(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_library/utils.py", line 295, in handle_dispatch_mode
    return curr_mode.__torch_dispatch__(op_overload, overload_types, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/utils/_stats.py", line 21, in wrapper
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 1343, in __torch_dispatch__
    return proxy_call(self, func, self.pre_dispatch, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/proxy_tensor.py", line 912, in proxy_call
    out = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_ops.py", line 723, in __call__
    return self._op(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/sym_node.py", line 512, in guard_bool
    r = self.shape_env.evaluate_expr(self.expr, self.hint, fx_node=self.fx_node)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/recording.py", line 263, in wrapper
    return retlog(fn(*args, **kwargs))
                  ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/symbolic_shapes.py", line 6303, in evaluate_expr
    return self._evaluate_expr(
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/fx/experimental/symbolic_shapes.py", line 6493, in _evaluate_expr
    raise self._make_data_dependent_error(

torch.fx.experimental.symbolic_shapes.GuardOnDataDependentSymNode: Could not guard on data-dependent expression Ne(u0, 2) (unhinted: Ne(u0, 2)).  (Size-like symbols: u0)

Caused by: (_ops.py:723 in __call__)
For more information, run with TORCH_LOGS="dynamic"
For extended logs when we create symbols, also add TORCHDYNAMO_EXTENDED_DEBUG_CREATE_SYMBOL="u0"
If you suspect the guard was triggered from C++, add TORCHDYNAMO_EXTENDED_DEBUG_CPP=1
For more debugging help, see https://docs.google.com/document/d/1HSuTTVvYH1pTew89Rtpeu84Ht3nQEFTYhAX3Ypa_xJs/edit?usp=sharing

For C++ stack trace, run with TORCHDYNAMO_EXTENDED_DEBUG_CPP=1

The following call raised this error:
  File "<string>", line 1, in <lambda>


While executing %scaled_dot_product_attention_default : [num_users=1] = call_function[target=torch.ops.aten.scaled_dot_product_attention.default](args = (%permute_default, %permute_default_1, %permute_default_2, %masked_fill_scalar, 0.0, 0), kwargs = {scale: None, enable_gqa: 0})
Original traceback:
None


# ⚠️ Errors from strategy 'LegacyDynamoStrategy': -----------------------

Traceback (most recent call last):

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 110, in __call__
    exported_program = self._capture(model, args, kwargs, dynamic_shapes)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/onnx/_internal/exporter/_capture_strategies.py", line 325, in _capture
    graph_module, _ = torch._dynamo.export(
                      ^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 1569, in inner
    result_traced = opt_f(*args, **kwargs)
                    ^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/eval_frame.py", line 574, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 1380, in __call__
    return self._torchdynamo_orig_callable(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 547, in __call__
    return _compile(
           ^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 986, in _compile
    guarded_code = compile_inner(code, one_graph, hooks, transform)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 715, in compile_inner
    return _compile_inner(code, one_graph, hooks, transform)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_utils_internal.py", line 95, in wrapper_function
    return function(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 750, in _compile_inner
    out_code = transform_code_object(code, transform)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/bytecode_transformation.py", line 1361, in transform_code_object
    transformations(instructions, code_options)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 231, in _fn
    return fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/convert_frame.py", line 662, in transform
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2868, in run
    super().run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py", line 443, in call_function
    return tx.inline_user_function_return(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 378, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2341, in CALL
    self._call(inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2335, in _call
    self.call_function(fn, args, kwargs)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/nn_module.py", line 443, in call_function
    return tx.inline_user_function_return(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1736, in CALL_FUNCTION_EX
    self.call_function(fn, argsvars.items, kwargsvars)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 378, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 317, in call_function
    return super().call_function(tx, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 118, in call_function
    return tx.inline_user_function_return(self, [*self.self_args(), *args], kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 903, in inline_user_function_return
    return InliningInstructionTranslator.inline_call(self, fn, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3072, in inline_call
    return cls.inline_call_(parent, func, args, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 3198, in inline_call_
    tracer.run()

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 1052, in run
    while self.step():
          ^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 962, in step
    self.dispatch_table[inst.opcode](self, inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 659, in wrapper
    return inner_fn(self, inst)
           ^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2341, in CALL
    self._call(inst)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 2335, in _call
    self.call_function(fn, args, kwargs)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/symbolic_convert.py", line 897, in call_function
    self.push(fn.call_function(self, args, kwargs))  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/variables/functions.py", line 687, in call_function
    unimplemented(msg)

  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/exc.py", line 317, in unimplemented
    raise Unsupported(msg, case_name=case_name)

torch._dynamo.exc.Unsupported: 'skip function pack_padded_sequence in file /Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/utils/rnn.py'

from user code:
   File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/_dynamo/external_utils.py", line 45, in inner
    return fn(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/kokoro/model.py", line 93, in forward
    d = self.predictor.text_encoder(d_en, s, input_lengths, text_mask)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/adrianlyjak/dev/onnx/.venv/lib/python3.12/site-packages/kokoro/modules.py", line 166, in forward
    x = nn.utils.rnn.pack_padded_sequence(

Set TORCH_LOGS="+dynamo" and TORCHDYNAMO_VERBOSE=1 for more information


```

